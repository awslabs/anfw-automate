Version: 0.1.0
Description: Configure Network Firewall
Config:
  - VPC: vpc-0d190cc0279200e9b
    Type: ANFW::VPC
    Properties:
      - HTTPS:
          - .amazonaws.com
          - .google.com
          - .example.com
      - HTTP:
          - amazonaws.com
          - google.com
          - HelpDomain.org
      - CUSTOM:
          # NOTE: the rule variable name must match the format a{aws_account_id}{vpc-id-without-prefix}
          - 'pass http $a8683633126180d190cc0279200e9b any -> $EXTERNAL_NET any (http.host; content:"amazon.com"; startswith; endswith; flow:to_server, established;)'
          - 'pass tls $a8683633126180d190cc0279200e9b any -> $EXTERNAL_NET any (tls.sni; dotprefix; content:".facebook.com"; endswith; flow:to_server, established;)'